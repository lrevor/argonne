C     THIS IS THE MAIN DRIVER PROGRAM
      include 'int_par.inc'
      include 'fcube.h'
c
      INTEGER MAT_TAB(PCOUNT, MAXNUM)

      INTEGER FRAG(MAXNUM)
      INTEGER*4 NEXT_POS(0:PNUM), PLIST(0:PNUM)
      INTEGER COUNT, COUNT2, M
      INTEGER HOST

      INTEGER T1, T2

      HOST = myhost()
      T1 = MCLOCK()

      DO 900 COUNT=1, MAXNUM
       DO 900 COUNT2=1, PCOUNT
       MAT_TAB(COUNT2,COUNT) = 0
 900  CONTINUE

      CALL SEQ_GEN(SCOUNT, SEQ, SEED, WRDLEN)
      CALL FRAG_GEN(M, MAXNUM, N, LOW, HIGH, FRAG, SEQLEN)

      CALL MATGEN (PLEN, PNUM, PCOUNT, N, M, MAXNUM, WRDLEN, SCOUNT,
     1             PLIST, FRAG, MAT_TAB, SEQ)

      T2 = MCLOCK() - T1

      CALL STAT(PLEN, PNUM, PCOUNT, MAXNUM, M, NEXT_POS, MAT_TAB,
     1          PLIST, WRDLEN)

      WRITE(*,500) 'THE GENERATION TOOK ', T2, ' SECONDS'   
  500 FORMAT (A21, I10, A8)  
      
      CALL CSEND(0,HOST,4,HOST,100)

      END
