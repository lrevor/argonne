C     THIS IS THE MAIN DRIVER PROGRAM

      INTEGER COUNT, COUNT2, PNUM, M, MAXNUM, N, PLEN, SEQLEN
      INTEGER LOW, HIGH
      REAL SEED
      PARAMETER (N=1000, LOW=333, HIGH=666)
      PARAMETER (MAXNUM=31) 
      INTEGER FRAG(MAXNUM)
      PARAMETER (PLEN=6, PNUM=4096, SEQLEN=10000, SEED=0.45)
      CHARACTER MAT_OUT*31, SEQ*10000
      LOGICAL MAT_TAB(MAXNUM, PNUM)
C     DATA ((MAT_TAB(I,J),I=1,MAXNUM),J=1,PNUM) /11706368*.FALSE./

      REAL TDUM, T1, T2, SECOND

      T1 = SECOND(TDUM)

      DO 900 COUNT=1, MAXNUM
       DO 900 COUNT2=1, PNUM
       MAT_TAB(COUNT,COUNT2) = .FALSE.
 900  CONTINUE

      CALL SEQ_GEN(SEQLEN, SEED, SEQ)
      CALL FRAG_GEN(M, MAXNUM, N, LOW, HIGH, FRAG, SEED, SEQLEN)

      CALL MATGEN (PLEN, PNUM, N, M, MAXNUM, MAT_TAB, FRAG, SEQ, 
     1             SEQLEN, HIGH, LOW)

      T2 = SECOND(TDUM) - T1

      WRITE(*,500) 'THE PROCESS TOOK ', T2, ' SECONDS'   
  500 FORMAT (A, F10.4, A)  
      
      OPEN (UNIT=1, FILE='seq3.dat')
      CLOSE (1, STATUS='DELETE')
      OPEN (UNIT=1, FILE='seq3.dat', ACCESS='SEQUENTIAL',
     1      FORM='FORMATTED', STATUS='NEW')
      WRITE(1,10) SEQ
      CLOSE(1)

      OPEN (UNIT=1, FILE='prob_match5.dat')
      CLOSE (1, STATUS='DELETE')
      OPEN (UNIT=1, FILE='prob_match5.dat', ACCESS='SEQUENTIAL',
     1      FORM='FORMATTED', STATUS='NEW')
      DO 110 COUNT=1, PNUM
        DO 120 COUNT2=1, M
          IF (MAT_TAB(COUNT2, COUNT)) THEN
            MAT_OUT(COUNT2:COUNT2)='T'
           ELSE
            MAT_OUT(COUNT2:COUNT2)='F'
          END IF
  120   CONTINUE
      WRITE(1,10) MAT_OUT
   10 FORMAT (A)
  110 CONTINUE
      CLOSE(1)

      OPEN (UNIT=1, FILE='frag3.dat')
      CLOSE (1, STATUS='DELETE')
      OPEN (UNIT=1, FILE='frag3.dat', ACCESS='SEQUENTIAL',
     1      FORM='FORMATTED', STATUS='NEW')
      DO 600 I = 1, M
      WRITE(1,*) SEQ(FRAG(I):FRAG(I)+N-1)
  600 CONTINUE
      CLOSE (1)

      T1 = SECOND(TDUM) - T2
      WRITE(*,500) 'WRITING THE FILES TOOK ', T1,' SECONDS'

      STOP
      END
