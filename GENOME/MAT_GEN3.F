C     THIS SUBROUTINE WILL GENERATE THE TABLE OF MATCHES BETWEEN PROB'S AND
C       FRAG'S

      SUBROUTINE MATGEN (PLEN, PCOUNT, FLEN, FNUM, MAXNUM, WORDSIZE,
     1                   PLIST, PNUM, MAT_TAB, FRAG, SEQ)

      INTEGER PLEN, PCOUNT, FLEN, FNUM, COUNT, COUNT2, WORDSIZE, PNUM
      INTEGER BASECONV, FRAG(FNUM), POSIT, POSIT1, POSIT2
      INTEGER MAT_TAB(PCOUNT, MAXNUM), PLIST(0:PNUM)
      CHARACTER*(*) SEQ

      DO 110 COUNT = 1, FNUM
       DO 50 COUNT2 = 0, PNUM
        PLIST(COUNT2) = 0
  50   CONTINUE
C
       DO 100 COUNT2 = 1, (FLEN-PLEN+1)
        POSIT1 = FRAG(COUNT)+COUNT2-1
        POSIT2 = POSIT1+PLEN-1
        POSIT = BASECONV(SEQ(POSIT1:POSIT2),PLEN)
        PLIST(POSIT) = 1
  100 CONTINUE
       CALL SET_BIT (MAT_TAB(1,COUNT), PLIST, PNUM, WORDSIZE)
  110 CONTINUE

      RETURN
      END
